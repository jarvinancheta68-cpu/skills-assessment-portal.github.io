<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vocational Skills Assessment Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #3b82f6;
            --secondary-color: #10b981;
            --danger-color: #ef4444;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 1rem;
        }
        .app-container {
            max-width: 600px;
            width: 100%;
            background-color: #ffffff;
            border-radius: 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-top: 1rem;
        }
        .button-primary {
            background-color: var(--primary-color);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            transition: background-color 0.2s;
        }
        .button-primary:hover {
            background-color: #2563eb;
        }
        .button-secondary {
            background-color: var(--secondary-color);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            transition: background-color 0.2s;
        }
        .button-secondary:hover {
            background-color: #059669;
        }
        .button-danger {
            background-color: var(--danger-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s;
        }
        .button-danger:hover {
            background-color: #dc2626;
        }
        .custom-radio input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }
        .custom-radio label {
            display: block;
            cursor: pointer;
            padding: 1rem;
            border-radius: 0.75rem;
            margin-bottom: 0.5rem;
            border: 2px solid #e5e7eb;
            transition: all 0.2s;
            font-weight: 500;
        }
        .custom-radio input[type="radio"]:checked + label {
            border-color: var(--primary-color);
            background-color: #eff6ff;
            box-shadow: 0 0 0 2px #bfdbfe;
        }
    </style>
</head>
<body>

<div id="app" class="app-container">
    <div id="loading-screen" class="text-center p-8">
        <svg class="animate-spin h-8 w-8 text-blue-500 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        <p class="mt-4 text-gray-600">Initializing database and authentication...</p>
    </div>

</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, signOut, updateProfile } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, doc, setDoc, getDoc, collection, onSnapshot, runTransaction, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    setLogLevel('debug');

    let app, db, auth;
    let userId = null;
    let userName = null;
    let userRecords = null;
    let isAuthReady = false;

    const firebaseConfig = {
        apiKey: "AIzaSyDM4X5HE-cwZLmx0E2uh2czvgfa1mmiJAI",
        authDomain: "skills-assessment-portal.firebaseapp.com",
        projectId: "skills-assessment-portal",
        storageBucket: "skills-assessment-portal.firebasestorage.app",
        messagingSenderId: "837656869746",
        appId: "1:837656869746:web:467318005b0241a49ebbeb"
    };
    
    const appId = firebaseConfig.projectId;
    const initialAuthToken = null;

    let currentView = 'auth';
    let currentQuizCategory = null;
    let currentQuestionIndex = 0;
    let currentQuizAnswers = {};

    const QUIZ_DATA = {
        'COMPUTER HARDWARE SERVICING': [
            { q: "Which tool is used for hardware to stand on to prevent static electricity from building up?", options: ["Hex driver", "Wire cutter", "Anti-static mat", "Philips head screwdriver"], a: "Anti-static mat" },
            { q: "What is the main 'brain' or 'heart' of a computer system?", options: ["Motherboard", "RAM", "CPU (Central Processing Unit)", "System Unit"], a: "CPU (Central Processing Unit)" },
            { q: "Which component performs arithmetic and logic operations?", options: ["CU (Control Unit)", "ALU (Arithmetic Logic Unit)", "Register", "Cache"], a: "ALU (Arithmetic Logic Unit)" },
            { q: "The primary circuit board of a PC, containing the CPU and slots for other devices, is called the:", options: ["Video Card", "Power Supply", "Motherboard", "Hard Disk Drive"], a: "Motherboard" },
            { q: "USB is the acronym of:", options: ["Universal Series Bus", "Universal System Bus", "Universal Serial Bus", "Data Bus"], a: "Universal Serial Bus" },
            { q: "What should you do first when a computer won't turn on?", options: ["Replace the motherboard", "Check if it's plugged in and the power supply is working", "Delete all files", "Upgrade the RAM"], a: "Check if it's plugged in and the power supply is working" },
            { q: "Which component is responsible for cooling the CPU in a desktop PC?", options: ["Hard drive", "Heat sink and fan", "Graphics card", "USB ports"], a: "Heat sink and fan" },
            { q: "When installing a new graphics card, what must you ensure?", options: ["It matches the motherboard's slot type", "The power supply has enough wattage", "The monitor is turned off", "All of the above"], a: "All of the above" },
            { q: "What tool is commonly used to open a computer case without damaging it?", options: ["Hammer", "Screwdriver", "Pliers", "Drill"], a: "Screwdriver" },
            { q: "If a hard drive is making clicking sounds, what might be the issue?", options: ["It's overheating", "Mechanical failure, like a failing platter", "Too much RAM", "Outdated software"], a: "Mechanical failure, like a failing platter" },
            { q: "True or False: ESD (Electrostatic Discharge) can damage computer components, so you should use an anti-static wristband.", options: ["True", "False"], a: "True" },
            { q: "True or False: RAM stands for Random Access Memory and is used for long-term data storage.", options: ["True", "False"], a: "False" },
            { q: "True or False: Overclocking a GPU can improve gaming performance but may void warranties.", options: ["True", "False"], a: "True" },
            { q: "True or False: A PSU (Power Supply Unit) converts AC power to DC for computer components.", options: ["True", "False"], a: "True" },
            { q: "True or False: Firmware updates for hardware like BIOS can fix compatibility issues.", options: ["True", "False"], a: "True" },
            { q: "True or False: SSDs are faster than HDDs because they have no moving parts.", options: ["True", "False"], a: "True" },
            { q: "True or False: Thermal paste helps conduct heat away from the CPU to the cooler.", options: ["True", "False"], a: "True" },
            { q: "True or False: A motherboard's chipset determines what CPUs and RAM it can support.", options: ["True", "False"], a: "True" },
            { q: "True or False: Defragmenting a hard drive organizes data for better performance on HDDs.", options: ["True", "False"], a: "True" },
            { q: "True or False: USB 3.0 ports are faster than USB 2.0 for data transfer.", options: ["True", "False"], a: "True" },
        ],
        'GARMENTS AND FASHION DESIGN TECHNOLOGY': [
            { q: "What is the term for the vertical yarns in a woven fabric?", options: ["Weft", "Selvedge", "Warp", "Grain"], a: "Warp" },
            { q: "Which spinning method is known for producing compact and strong yarns?", options: ["Open-end spinning", "Ring spinning", "Air-jet spinning", "Friction spinning"], a: "Ring spinning" },
            { q: "What is the primary purpose of sizing in the weaving process?", options: ["Adding color to the yarn", "Reducing the thickness", "Improving yarn strength", "Removing impurities"], a: "Improving yarn strength" },
            { q: "The process of converting waste material into a new product is called:", options: ["Redesigning", "Recycling", "Reformation", "Recreation"], a: "Recycling" },
            { q: "Which of the following is an elastomeric fiber?", options: ["Acrylic", "Nylon", "Spandex", "Mod Acrylic"], a: "Spandex" },
            { q: "What does \"draping\" refer to in fashion design?", options: ["Cutting fabric with scissors", "Pinning fabric directly on a mannequin to create shapes", "Sewing hems by hand", "Dyeing fabric colors"], a: "Pinning fabric directly on a mannequin to create shapes" },
            { q: "Which of these is a key element of sustainable fashion?", options: ["Using only synthetic materials", "Recycling old clothes into new designs", "Ignoring fabric origins", "Mass-producing identical items"], a: "Recycling old clothes into new designs" },
            { q: "In garment construction, what is the purpose of a \"seam allowance\"?", options: ["To add decorative stitches", "To provide extra fabric for sewing and fitting", "To measure fabric weight", "To choose thread color"], a: "To provide extra fabric for sewing and fitting" },
            { q: "Which tool is essential for creating accurate patterns in fashion design?", options: ["Iron", "Ruler and French curve", "Hair dryer", "Glue gun"], a: "Ruler and French curve" },
            { q: "What fabric is best for winter coats due to its warmth and water resistance?", options: ["Chiffon", "Wool", "Organza", "Tulle"], a: "Wool" },
            { q: "True or False: The \"straight grain\" of fabric runs parallel to the selvage and is the strongest direction for sewing.", options: ["True", "False"], a: "True" },
            { q: "True or False: Bias cut garments stretch more easily and drape better than those cut on the straight grain.", options: ["True", "False"], a: "True" },
            { q: "True or False: A \"muslin\" is a type of finished garment worn in formal events.", options: ["True", "False"], a: "False" },
            { q: "True or False: Color theory in fashion helps designers choose palettes that evoke emotions, like red for passion.", options: ["True", "False"], a: "True" },
            { q: "True or False: \"Fast fashion\" promotes slow production to reduce environmental impact.", options: ["True", "False"], a: "False" },
            { q: "True or False: Pleats are folds in fabric that add volume and can be pressed or unpressed.", options: ["True", "False"], a: "True" },
            { q: "True or False: In fashion sketching, proportions are exaggerated to highlight design features.", options: ["True", "False"], a: "True" },
            { q: "True or False: Denim is a fabric made from cotton and is commonly used for jeans.", options: ["True", "False"], a: "True" },
            { q: "True or False: A \"bolero\" is a long, flowing cape worn over dresses.", options: ["True", "False"], a: "False" },
            { q: "True or False: Textile printing techniques like screen printing allow for custom patterns on fabrics.", options: ["True", "False"], a: "True" },
        ],
        'FOOD SERVICING AND MANAGEMENT TECHNOLOGY': [
            { q: "The person who serves alcoholic beverages in a restaurant is called a:", options: ["Trancheur", "Sommelier", "Debarrasseur", "Commise de rang"], a: "Sommelier" },
            { q: "What is the proper refrigerator temperature range in degrees Fahrenheit to prevent bacterial growth?", options: ["Less than 32°F", "32°F - 40°F", "40°F - 45°F", "45°F - 50°F"], a: "32°F - 40°F" },
            { q: "Which of the following should NOT be used to thaw frozen meats?", options: ["Refrigerator thawing", "Defrost under cold running water", "Defrost in microwave", "Defrost at room temperature"], a: "Defrost at room temperature" },
            { q: "What system is crucial for defining and monitoring critical points in food preparation to ensure safety?", options: ["FIFO", "HACCP", "POS", "RFP"], a: "HACCP" },
            { q: "A restaurant that primarily offers counter service and limited seating, like a hot dog stand or sandwich shop, represents which service type?", options: ["Fine dining", "Full service", "Catering", "Quick Service"], a: "Quick Service" },
            { q: "What is the primary goal of food safety protocols in a restaurant?", options: ["To make food taste better", "To prevent foodborne illnesses", "To reduce cooking time", "To increase portion sizes"], a: "To prevent foodborne illnesses" },
            { q: "Which method helps preserve food freshness in a commercial kitchen?", options: ["Leaving it out at room temperature", "Using FIFO (First In, First Out) for inventory", "Mixing raw and cooked foods", "Ignoring expiration dates"], a: "Using FIFO (First In, First Out) for inventory" },
            { q: "In menu planning, what does \"portion control\" aim to achieve?", options: ["Higher profits through larger servings", "Balanced nutrition and cost efficiency", "Faster service times", "More variety in dishes"], a: "Balanced nutrition and cost efficiency" },
            { q: "What equipment is essential for safe food storage in a freezer?", options: ["Metal shelves", "Thermometer to monitor temperature", "Open containers", "Bright lighting"], a: "Thermometer to monitor temperature" },
            { q: "How can a restaurant manager ethically reduce food waste?", options: ["Over-preparing meals", "Donating leftovers to shelters", "Using expired ingredients", "Ignoring customer feedback"], a: "Donating leftovers to shelters" },
            { q: "True or False: The danger zone for bacterial growth in food is between 40°F and 140°F.", options: ["True", "False"], a: "True" },
            { q: "True or False: HACCP is a system for identifying and controlling food safety hazards.", options: ["True", "False"], a: "True" },
            { q: "True or False: Cross-contamination occurs when raw meat juices touch ready-to-eat foods.", options: ["True", "False"], a: "True" },
            { q: "True or False: A sanitizer is used to clean surfaces after washing with soap.", options: ["True", "False"], a: "True" },
            { q: "True or False: Food labels must include ingredients and allergens for transparency.", options: ["True", "False"], a: "True" },
            { q: "True or False: Buffet-style service requires frequent temperature checks to prevent spoilage.", options: ["True", "False"], a: "True" },
            { q: "True or False: Inventory turnover rate measures how quickly stock is sold and replaced.", options: ["True", "False"], a: "True" },
            { q: "True or False: Sous-vide cooking involves vacuum-sealing food and cooking in water at precise temperatures.", options: ["True", "False"], a: "True" },
            { q: "True or False: Food costing includes calculating the price of ingredients per dish.", options: ["True", "False"], a: "True" },
            { q: "True or False: Employee training on hygiene reduces the risk of food poisoning outbreaks.", options: ["True", "False"], a: "True" },
        ],
        'ELECTRICAL TECHNOLOGY': [
            { q: "What is the SI unit of electrical resistance?", options: ["Ampere", "Volt", "Ohm", "Watt"], a: "Ohm" },
            { q: "According to Kirchhoff's voltage law, the algebraic sum of all IR drops and EMFs in any closed loop of a network is always:", options: ["Positive", "Negative", "Zero", "Determined by EMFs"], a: "Zero" },
            { q: "The main function of a fuse is to:", options: ["Protect the line", "Open the circuit", "Prevent excessive currents", "Protect the appliance"], a: "Prevent excessive currents" },
            { q: "Which law describes the relationship between the current flowing through a conductor and the voltage across it?", options: ["Lenz's Law", "Faraday's Law", "Ohm's Law", "Kirchhoff's Law"], a: "O
